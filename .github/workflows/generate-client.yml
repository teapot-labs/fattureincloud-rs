name: Generate Rust SDK
on: [workflow_dispatch]

jobs:
  generate-rust-sdk:
    runs-on: ubuntu-latest
    steps:

      - id: checkout
        name: Checkout repo
        uses: actions/checkout@v3

      - id: generate-client
        name: Generate Rust Client
        uses: openapi-generators/openapitools-generator-action@v1
        with:
          generator: rust
          openapi-url: https://github.com/fattureincloud/openapi-fattureincloud/raw/master/openapi-enriched.yaml
          config-file: openapi-config.json

      - id: create-pr
        name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          path: ./rust-client
          branch: "rename-me"
          delete-branch: true
          base: master
          commit-message: "chore: bumping version to 0.0"
          title: "Updating SDK to 0.0"
          body: "New SDK verson generated by Github Action from OpenAPI Spec"
